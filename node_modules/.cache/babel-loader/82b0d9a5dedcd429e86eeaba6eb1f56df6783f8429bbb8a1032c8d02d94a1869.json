{"ast":null,"code":"import React from'react';import{json,checkStatus}from'./util';import Chart from'chart.js/auto';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";class Graph extends React.Component{constructor(props){super(props);this.getHistoricalRates=(base,quote)=>{const{lastMonth,today}=this.state;fetch(`https://api.frankfurter.app/${lastMonth}..${today}?from=${base}&to=${quote}`).then(checkStatus).then(json).then(data=>{if(data.error){throw new Error(data.error);}const chartLabels=Object.keys(data.rates);// Dates\nconst chartData=Object.values(data.rates).map(rate=>rate[quote]);// Rates\nconst chartLabel=`${base}/${quote}`;this.buildChart(chartLabels,chartData,chartLabel);}).catch(error=>{this.setState({error:error.message});console.error('Error fetching historical rates:',error);});};this.buildChart=(labels,data,label)=>{if(this.chart){this.chart.destroy();// Destroy previous chart instance\n}this.chart=new Chart(this.chartRef.current,{type:'line',data:{labels,datasets:[{label:label,data,fill:false,borderColor:'rgba(75, 192, 192, 1)',tension:0.1}]},options:{responsive:true,plugins:{legend:{display:true,position:'top'}},scales:{x:{title:{display:true,text:'Date'}},y:{title:{display:true,text:'Exchange Rate'}}}}});};const _today=new Date();const _lastMonth=new Date();_lastMonth.setMonth(_today.getMonth()-1);// Set date to 1 month ago\nthis.state={timeSeries:{},today:_today.toISOString().split('T')[0],// Format date as YYYY-MM-DD\nlastMonth:_lastMonth.toISOString().split('T')[0],error:''};this.chartRef=/*#__PURE__*/React.createRef();// Create a ref for the chart\n}componentDidMount(){const{baseCurrency,targetCurrency}=this.props.match.params;// Get params from URL\nthis.getHistoricalRates(baseCurrency,targetCurrency);// Fetch historical rates\n}render(){const{error}=this.state;const{baseCurrency,targetCurrency}=this.props.match.params;return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Time Series for \",baseCurrency,\" to \",targetCurrency]}),error?/*#__PURE__*/_jsx(\"p\",{className:\"text-danger\",children:error}):/*#__PURE__*/_jsx(\"canvas\",{ref:this.chartRef})// Canvas for Chart.js\n]});}}export default Graph;","map":{"version":3,"names":["React","json","checkStatus","Chart","jsxs","_jsxs","jsx","_jsx","Graph","Component","constructor","props","getHistoricalRates","base","quote","lastMonth","today","state","fetch","then","data","error","Error","chartLabels","Object","keys","rates","chartData","values","map","rate","chartLabel","buildChart","catch","setState","message","console","labels","label","chart","destroy","chartRef","current","type","datasets","fill","borderColor","tension","options","responsive","plugins","legend","display","position","scales","x","title","text","y","Date","setMonth","getMonth","timeSeries","toISOString","split","createRef","componentDidMount","baseCurrency","targetCurrency","match","params","render","className","children","ref"],"sources":["/Users/ravichasuksawasdinaayuthaya/Fullstack Practice/Altcademy/ReactJS-SPA/Currency-converter-ReactJS/src/graph.js"],"sourcesContent":["import React from 'react';\nimport { json, checkStatus } from './util';\nimport Chart from 'chart.js/auto';\n\nclass Graph extends React.Component {\n  constructor(props) {\n    super(props);\n    const today = new Date();\n    const lastMonth = new Date();\n    lastMonth.setMonth(today.getMonth() - 1); // Set date to 1 month ago\n\n    this.state = {\n      timeSeries: {},\n      today: today.toISOString().split('T')[0], // Format date as YYYY-MM-DD\n      lastMonth: lastMonth.toISOString().split('T')[0],\n      error: '',\n    };\n\n    this.chartRef = React.createRef(); // Create a ref for the chart\n  }\n\n  componentDidMount() {\n    const { baseCurrency, targetCurrency } = this.props.match.params; // Get params from URL\n    this.getHistoricalRates(baseCurrency, targetCurrency); // Fetch historical rates\n  }\n\n  getHistoricalRates = (base, quote) => {\n    const { lastMonth, today } = this.state;\n    fetch(`https://api.frankfurter.app/${lastMonth}..${today}?from=${base}&to=${quote}`)\n      .then(checkStatus)\n      .then(json)\n      .then((data) => {\n        if (data.error) {\n          throw new Error(data.error);\n        }\n        const chartLabels = Object.keys(data.rates); // Dates\n        const chartData = Object.values(data.rates).map((rate) => rate[quote]); // Rates\n        const chartLabel = `${base}/${quote}`;\n        this.buildChart(chartLabels, chartData, chartLabel);\n      })\n      .catch((error) => {\n        this.setState({ error: error.message });\n        console.error('Error fetching historical rates:', error);\n      });\n  };\n\n  buildChart = (labels, data, label) => {\n    if (this.chart) {\n      this.chart.destroy(); // Destroy previous chart instance\n    }\n\n    this.chart = new Chart(this.chartRef.current, {\n      type: 'line',\n      data: {\n        labels,\n        datasets: [\n          {\n            label: label,\n            data,\n            fill: false,\n            borderColor: 'rgba(75, 192, 192, 1)',\n            tension: 0.1,\n          },\n        ],\n      },\n      options: {\n        responsive: true,\n        plugins: {\n          legend: {\n            display: true,\n            position: 'top',\n          },\n        },\n        scales: {\n          x: {\n            title: {\n              display: true,\n              text: 'Date',\n            },\n          },\n          y: {\n            title: {\n              display: true,\n              text: 'Exchange Rate',\n            },\n          },\n        },\n      },\n    });\n  };\n\n  render() {\n    const { error } = this.state;\n    const { baseCurrency, targetCurrency } = this.props.match.params;\n\n    return (\n      <div className=\"container\">\n        <h2>Time Series for {baseCurrency} to {targetCurrency}</h2>\n        {error ? (\n          <p className=\"text-danger\">{error}</p>\n        ) : (\n          <canvas ref={this.chartRef} /> // Canvas for Chart.js\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Graph;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}